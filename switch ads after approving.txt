//üî•–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç—å 3 –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ /*–•*///


//***************************************************************************************************************************//
//–°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –≥—Ä—É–ø–ø –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∏–º–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ –≥—Ä—É–ø–ø –æ–±—ä—è–≤–ª–µ–Ω–∏–π//
//–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–≤–µ –≤–µ—â–∏:
//1. –û–±—ä—è–≤–ª–µ–Ω–∏—è, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ —è—Ä–ª—ã–∫–æ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π switch_on_label. –ï—Å–ª–∏ –æ–Ω–∏ –ø—Ä–æ—à–ª–∏ –º–æ–¥–µ—Ä–∞—Ü–∏—é, —Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è, —Å –Ω–∏—Ö —Å–Ω–∏–º–∞–µ—Ç—Å—è —è—Ä–ª—ã–∫
//–∏ –≤ —Ç–µ—Ö –∂–µ –≥—Ä—É–ø–ø–∞—Ö –∏—â—É—Ç—Å—è –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å —è—Ä–ª—ã–∫–æ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π switch_off_label, —Å –Ω–∏—Ö —Ç–∞–∫–∂–µ —Å–Ω–∏–º–∞–µ—Ç—Å—è —è—Ä–ª—ã–∫
//2. –ì—Ä—É–ø–ø—ã –æ–±—ä—è–≤–ª–µ–Ω–∏–π, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ —è—Ä–ª—ã–∫–æ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π switch_on_label. –ï—Å–ª–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–ª–∏ –º–æ–¥–µ—Ä–∞—Ü–∏—é, —Ç–æ –æ–Ω–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è,
//–∞ –≥—Ä—É–ø–ø—ã –≤ —Ç–æ–π –∂–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å —è—Ä–ª—ã–∫–æ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π switch_off_label –≤—ã–∫–ª—é—á–∞—é—Ç—Å—è. –Ø—Ä–ª—ã–∫–∏ —Å–Ω–∏–º–∞—é—Ç—Å—è —Å –æ–±–µ–∏—Ö —Ç–∏–ø–æ–≤ –≥—Ä—É–ø–ø.
//***************************************************************************************************************************//

function main(){
	/*1*///–í–º–µ—Å—Ç–æ XXX-XXX-XXXX —É–∫–∞–∂–∏—Ç–µ ID –∞–∫–∫–∞—É–Ω—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç
  var run = MccApp.accounts().withIds(['XXX-XXX-XXXX']).executeInParallel('doit');
}

function doit() { 
  /*2*///–í–º–µ—Å—Ç–æ switch_on_label —É–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —è—Ä–ª—ã–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫ –Ω–æ–≤—ã–º –≥—Ä—É–ø–ø–∞–º –æ–±—ä—è–≤–ª–µ–Ω–∏–π/–æ–±—ä—è–≤–ª–µ–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
  var switch_on_label = "SwitchOnAfterApproval";
  /*3*///–í–º–µ—Å—Ç–æ switch_off_label —É–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —è—Ä–ª—ã–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫ —Å—Ç–∞—Ä—ã–º –≥—Ä—É–ø–ø–∞–º –æ–±—ä—è–≤–ª–µ–Ω–∏–π/–æ–±—ä—è–≤–ª–µ–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–∫–ª—é—á–µ–Ω—ã –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–º–∏ switch_on_label
  var switch_off_label = "SwitchOffAfterApproval";
  
  ////////////////SWITCHING ADS////////////////
  var switch_on_ads = AdsApp.ads().withCondition('LabelNames CONTAINS_ANY ["'+switch_on_label+'"] AND CombinedApprovalStatus = APPROVED AND AdGroupStatus != REMOVED').get();
  while (switch_on_ads.hasNext()){
      var switch_on_ad = switch_on_ads.next();
      switch_on_ad.removeLabel(switch_on_label);
      switch_on_ad.enable();
      var current_adgroup_id = switch_on_ad.getAdGroup().getId();
      var switch_off_ads = AdsApp.ads().withCondition('AdGroupId = "'+ current_adgroup_id +'" AND LabelNames CONTAINS_ANY ["'+switch_off_label+'"]').get();
      while (switch_off_ads.hasNext()){
          var switch_off_ad = switch_off_ads.next();
          switch_off_ad.removeLabel(switch_off_label);
          switch_off_ad.pause();
      }
  }
  ////////////////END OF SWITCHING ADS////////////////
  
  ////////////////SWITCHING VIDEO ADS////////////////
  var switch_on_ads = AdsApp.videoAds().withCondition('LabelNames CONTAINS_ANY ["'+switch_on_label+'"] AND CombinedApprovalStatus = APPROVED AND AdGroupStatus != REMOVED').get();
  while (switch_on_ads.hasNext()){
      var switch_on_ad = switch_on_ads.next();
      switch_on_ad.removeLabel(switch_on_label);
      switch_on_ad.enable();
      var current_adgroup_id = switch_on_ad.getVideoAdGroup().getId();
      var switch_off_ads = AdsApp.videoAds().withCondition('AdGroupId = "'+ current_adgroup_id +'" AND LabelNames CONTAINS_ANY ["'+switch_off_label+'"]').get();
      while (switch_off_ads.hasNext()){
          var switch_off_ad = switch_off_ads.next();
          switch_off_ad.removeLabel(switch_off_label);
          switch_off_ad.pause();
      }
  }  
  ////////////////END OF SWITCHING VIDEO ADS////////////////
  
  ////////////////SWITCHING AD GROUPS////////////////
  var switch_on_groups = AdsApp.adGroups().withCondition('LabelNames CONTAINS_ANY ["'+switch_on_label+'"] AND Status != REMOVED').get();
  while (switch_on_groups.hasNext()){
      var switch_on_group = switch_on_groups.next();
      if (switch_on_group.ads().withCondition('CombinedApprovalStatus = APPROVED').get().hasNext()){
          switch_on_group.enable();
          switch_on_group.removeLabel(switch_on_label);
          var current_campaign_id = switch_on_group.getCampaign().getId();
          var switch_off_groups = AdsApp.adGroups().withCondition('CampaignId = "'+ current_campaign_id +'" AND LabelNames CONTAINS_ANY ["'+switch_off_label+'"] ').get();
          while (switch_off_groups.hasNext()){
              var switch_off_group = switch_off_groups.next();
              switch_off_group.removeLabel(switch_off_label);
              switch_off_group.pause();
          }
      }
  }
  ////////////////END OF SWITCHING AD GROUPS////////////////
}